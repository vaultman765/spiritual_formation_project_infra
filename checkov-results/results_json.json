{"check_type": "terraform", "results": {"failed_checks": [{"check_id": "CKV_AWS_35", "bc_check_id": "BC_AWS_LOGGING_7", "check_name": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": null, "file_path": "/cloudtrail.tf", "file_abs_path": "/work/envs/prod/cloudtrail.tf", "repo_file_path": "/envs/prod/cloudtrail.tf", "file_line_range": [126, 138], "resource": "aws_cloudtrail.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudtrailEncryptionWithCMK", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-7", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/cloudtrail.tf", "breadcrumbs": {"tags.Project": [{"type": "tfvar", "name": "project", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "tags.Env": [{"type": "tfvar", "name": "env", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_252", "bc_check_id": "BC_AWS_GENERAL_175", "check_name": "Ensure CloudTrail defines an SNS Topic", "check_result": {"result": "FAILED", "evaluated_keys": ["sns_topic_name"]}, "code_block": null, "file_path": "/cloudtrail.tf", "file_abs_path": "/work/envs/prod/cloudtrail.tf", "repo_file_path": "/envs/prod/cloudtrail.tf", "file_line_range": [126, 138], "resource": "aws_cloudtrail.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudtrailDefinesSNSTopic", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-cloudtrail-defines-an-sns-topic", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/cloudtrail.tf", "breadcrumbs": {"tags.Project": [{"type": "tfvar", "name": "project", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "tags.Env": [{"type": "tfvar", "name": "env", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_master_key_id"]}, "code_block": null, "file_path": "/monitoring.tf", "file_abs_path": "/work/envs/prod/monitoring.tf", "repo_file_path": "/envs/prod/monitoring.tf", "file_line_range": [2, 4], "resource": "aws_sns_topic.alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/monitoring.tf", "breadcrumbs": {"name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": null, "file_path": "/secret_rotation.tf", "file_abs_path": "/work/envs/prod/secret_rotation.tf", "repo_file_path": "/envs/prod/secret_rotation.tf", "file_line_range": [2, 19], "resource": "aws_security_group.sm_rotation", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/secret_rotation.tf", "breadcrumbs": {"name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}], "vpc_id": [{"type": "variable", "name": "enabled", "path": "/work/modules/vpc/variables.tf", "module_connection": false}, {"type": "output", "name": "vpc_id", "path": "/work/modules/vpc/outputs.tf", "module_connection": false}], "tags.Project": [{"type": "tfvar", "name": "project", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "tags.Env": [{"type": "tfvar", "name": "env", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/envs/prod/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_50", "bc_check_id": "BC_AWS_SERVERLESS_4", "check_name": "X-Ray tracing is enabled for Lambda", "check_result": {"result": "FAILED", "evaluated_keys": ["tracing_config/[0]/mode"]}, "code_block": null, "file_path": "/secret_rotation_bridge.tf", "file_abs_path": "/work/envs/prod/secret_rotation_bridge.tf", "repo_file_path": "/envs/prod/secret_rotation_bridge.tf", "file_line_range": [96, 118], "resource": "aws_lambda_function.apprunner_redeploy[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaXrayEnabled", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/secret_rotation_bridge.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.apprunner_redeploy_zip", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}], "tags.Env": [{"type": "tfvar", "name": "env", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "tags.Project": [{"type": "tfvar", "name": "project", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "function_name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}], "kms_key_arn": [{"type": "output", "name": "kms_key_arn", "path": "/work/modules/kms/logs/outputs.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_272", "bc_check_id": "BC_AWS_General_201", "check_name": "Ensure AWS Lambda function is configured to validate code-signing", "check_result": {"result": "FAILED", "evaluated_keys": ["code_signing_config_arn"]}, "code_block": null, "file_path": "/secret_rotation_bridge.tf", "file_abs_path": "/work/envs/prod/secret_rotation_bridge.tf", "repo_file_path": "/envs/prod/secret_rotation_bridge.tf", "file_line_range": [96, 118], "resource": "aws_lambda_function.apprunner_redeploy[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaCodeSigningConfigured", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/secret_rotation_bridge.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.apprunner_redeploy_zip", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}], "tags.Env": [{"type": "tfvar", "name": "env", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "tags.Project": [{"type": "tfvar", "name": "project", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "function_name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}], "kms_key_arn": [{"type": "output", "name": "kms_key_arn", "path": "/work/modules/kms/logs/outputs.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["reserved_concurrent_executions/[0]"]}, "code_block": null, "file_path": "/secret_rotation_bridge.tf", "file_abs_path": "/work/envs/prod/secret_rotation_bridge.tf", "repo_file_path": "/envs/prod/secret_rotation_bridge.tf", "file_line_range": [96, 118], "resource": "aws_lambda_function.apprunner_redeploy[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/secret_rotation_bridge.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.apprunner_redeploy_zip", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}], "tags.Env": [{"type": "tfvar", "name": "env", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "tags.Project": [{"type": "tfvar", "name": "project", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "function_name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}], "kms_key_arn": [{"type": "output", "name": "kms_key_arn", "path": "/work/modules/kms/logs/outputs.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_241", "bc_check_id": "BC_AWS_GENERAL_115", "check_name": "Ensure that Kinesis Firehose Delivery Streams are encrypted with CMK", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": null, "file_path": "/waf.tf", "file_abs_path": "/work/envs/prod/waf.tf", "repo_file_path": "/envs/prod/waf.tf", "file_line_range": [224, 233], "resource": "aws_kinesis_firehose_delivery_stream.waf", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KinesisFirehoseDeliveryStreamUsesCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kinesis-firehose-delivery-streams-are-encrypted-with-cmk", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/waf.tf", "breadcrumbs": {"name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_240", "bc_check_id": "BC_AWS_GENERAL_154", "check_name": "Ensure Kinesis Firehose delivery stream is encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["server_side_encryption/[0]/enabled"]}, "code_block": null, "file_path": "/waf.tf", "file_abs_path": "/work/envs/prod/waf.tf", "repo_file_path": "/envs/prod/waf.tf", "file_line_range": [224, 233], "resource": "aws_kinesis_firehose_delivery_stream.waf", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KinesisFirehoseDeliveryStreamSSE", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/waf.tf", "breadcrumbs": {"name": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": null, "file_path": "/../../modules/apprunner/main.tf", "file_abs_path": "/work/modules/apprunner/main.tf", "repo_file_path": "/modules/apprunner/main.tf", "file_line_range": [17, 29], "resource": "module.apprunner.aws_security_group.apprunner", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/apprunner.tf", "caller_file_line_range": [4, 72], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/apprunner/main.tf", "breadcrumbs": {"source_module_": [{"type": "module", "name": "apprunner", "path": "/work/envs/prod/apprunner.tf", "idx": 50, "source_module_object": null}]}}, {"check_id": "CKV_AWS_374", "bc_check_id": "BC_AWS_NETWORKING_97", "check_name": "Ensure AWS CloudFront web distribution has geo restriction enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrictions/[0]/geo_restriction/[0]/restriction_type"]}, "code_block": null, "file_path": "/../../modules/cloudfront_site/main.tf", "file_abs_path": "/work/modules/cloudfront_site/main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [110, 188], "resource": "module.frontend_site_prod.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontGeoRestrictionDisabled", "fixed_definition": null, "entity_tags": {"Environment": ["prod"], "ManagedBy": ["Terraform"], "Project": ["spiritual"]}, "caller_file_path": "/frontend.tf", "caller_file_line_range": [5, 43], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/cloudfront_site/main.tf", "breadcrumbs": {"restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.default_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "default_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "viewer_certificate.acm_certificate_arn": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "acm_certificate_arn", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "logging_config.bucket": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "tags.Project": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "aliases": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "dynamic.custom_error_response.for_each": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "custom_error_response.error_code": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "dynamic.custom_error_response": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.target_origin_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "origin.origin_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.min_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "min_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "logging_config.prefix": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "comment": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.max_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "max_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "price_class": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "price_class", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "idx": 86, "source_module_object": null}]}}, {"check_id": "CKV_AWS_310", "bc_check_id": "BC_AWS_GENERAL_222", "check_name": "Ensure CloudFront distributions should have origin failover configured", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": null, "file_path": "/../../modules/cloudfront_site/main.tf", "file_abs_path": "/work/modules/cloudfront_site/main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [110, 188], "resource": "module.frontend_site_prod.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionOriginFailover", "fixed_definition": null, "entity_tags": {"Environment": ["prod"], "ManagedBy": ["Terraform"], "Project": ["spiritual"]}, "caller_file_path": "/frontend.tf", "caller_file_line_range": [5, 43], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/cloudfront_site/main.tf", "breadcrumbs": {"restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.default_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "default_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "viewer_certificate.acm_certificate_arn": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "acm_certificate_arn", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "logging_config.bucket": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "tags.Project": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "aliases": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "dynamic.custom_error_response.for_each": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "custom_error_response.error_code": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "dynamic.custom_error_response": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.target_origin_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "origin.origin_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.min_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "min_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "logging_config.prefix": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "comment": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.max_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "max_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "price_class": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "price_class", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "idx": 86, "source_module_object": null}]}}, {"check_id": "CKV_AWS_310", "bc_check_id": "BC_AWS_GENERAL_222", "check_name": "Ensure CloudFront distributions should have origin failover configured", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": null, "file_path": "/../../modules/cloudfront_static/main.tf", "file_abs_path": "/work/modules/cloudfront_static/main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 94], "resource": "module.static_admin_prod.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionOriginFailover", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": "/static_admin.tf", "caller_file_line_range": [6, 45], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/cloudfront_static/main.tf", "breadcrumbs": {"aliases": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.domain_name": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.min_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "min_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "comment": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.origin_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.max_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "max_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.default_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "default_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "tags.Project": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.origin_path": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "origin_path", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "logging_config.prefix": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "price_class": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "price_class", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.target_origin_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "viewer_certificate.acm_certificate_arn": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "acm_certificate_arn", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "logging_config.bucket": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "idx": 190, "source_module_object": null}]}}, {"check_id": "CKV_AWS_305", "bc_check_id": "BC_AWS_GENERAL_219", "check_name": "Ensure CloudFront distribution has a default root object configured", "check_result": {"result": "FAILED", "evaluated_keys": ["default_root_object"]}, "code_block": null, "file_path": "/../../modules/cloudfront_static/main.tf", "file_abs_path": "/work/modules/cloudfront_static/main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 94], "resource": "module.static_admin_prod.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionDefaultRoot", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": "/static_admin.tf", "caller_file_line_range": [6, 45], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-305", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/cloudfront_static/main.tf", "breadcrumbs": {"aliases": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.domain_name": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.min_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "min_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "comment": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.origin_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.max_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "max_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.default_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "default_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "tags.Project": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.origin_path": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "origin_path", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "logging_config.prefix": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "price_class": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "price_class", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.target_origin_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "viewer_certificate.acm_certificate_arn": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "acm_certificate_arn", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "logging_config.bucket": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "idx": 190, "source_module_object": null}]}}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["image_tag_mutability"]}, "code_block": null, "file_path": "/../../modules/ecr/main.tf", "file_abs_path": "/work/modules/ecr/main.tf", "repo_file_path": "/modules/ecr/main.tf", "file_line_range": [1, 9], "resource": "module.ecr_backend.aws_ecr_repository.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/ecr.tf", "caller_file_line_range": [1, 7], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/ecr/main.tf", "breadcrumbs": {"name": [{"type": "module", "name": "ecr_backend", "path": "/work/envs/prod/ecr.tf", "module_connection": false}, {"type": "variable", "name": "repository_name", "path": "/work/modules/ecr/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecr_repository.this", "path": "/work/modules/ecr/main.tf", "module_connection": false}], "image_tag_mutability": [{"type": "module", "name": "ecr_backend", "path": "/work/envs/prod/ecr.tf", "module_connection": false}, {"type": "variable", "name": "image_tag_mutability", "path": "/work/modules/ecr/variables.tf", "module_connection": false}], "encryption_configuration.kms_key": [{"type": "module", "name": "ecr_backend", "path": "/work/envs/prod/ecr.tf", "module_connection": false}, {"type": "variable", "name": "kms_key_arn", "path": "/work/modules/ecr/variables.tf", "module_connection": false}], "image_scanning_configuration.scan_on_push": [{"type": "module", "name": "ecr_backend", "path": "/work/envs/prod/ecr.tf", "module_connection": false}, {"type": "variable", "name": "scan_on_push", "path": "/work/modules/ecr/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "ecr_backend", "path": "/work/envs/prod/ecr.tf", "idx": 79, "source_module_object": null}]}}, {"check_id": "CKV_AWS_149", "bc_check_id": "BC_AWS_GENERAL_79", "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": null, "file_path": "/../../modules/rds/main.tf", "file_abs_path": "/work/modules/rds/main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [124, 128], "resource": "module.rds.aws_secretsmanager_secret.db", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted", "fixed_definition": null, "entity_tags": {"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": "/rds.tf", "caller_file_line_range": [8, 40], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/rds/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "secret_name", "path": "/work/modules/rds/variables.tf", "module_connection": false}, {"type": "locals", "name": "secret_name", "path": "/work/modules/rds/main.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "tags", "path": "/work/modules/rds/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "idx": 151, "source_module_object": null}]}}, {"check_id": "CKV_AWS_293", "bc_check_id": "BC_AWS_GENERAL_208", "check_name": "Ensure that AWS database instances have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": null, "file_path": "/../../modules/rds/main.tf", "file_abs_path": "/work/modules/rds/main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [131, 191], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstanceDeletionProtection", "fixed_definition": null, "entity_tags": {"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": "/rds.tf", "caller_file_line_range": [8, 40], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/rds/main.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "final_snapshot_prefix", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "snapshot_identifier": [{"type": "variable", "name": "restore_snapshot_identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "engine_version": [{"type": "variable", "name": "engine_version", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "deletion_protection": [{"type": "variable", "name": "deletion_protection", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "enabled_cloudwatch_logs_exports": [{"type": "variable", "name": "enabled_cloudwatch_logs_exports", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "db_name": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_name", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "max_allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "max_allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_interval": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "username": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_username", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_role_arn": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "multi_az": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "multi_az", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "instance_class": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "instance_class", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "tags", "path": "/work/modules/rds/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "idx": 151, "source_module_object": null}]}}, {"check_id": "CKV_AWS_161", "bc_check_id": "BC_AWS_IAM_65", "check_name": "Ensure RDS database has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": null, "file_path": "/../../modules/rds/main.tf", "file_abs_path": "/work/modules/rds/main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [131, 191], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication", "fixed_definition": null, "entity_tags": {"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": "/rds.tf", "caller_file_line_range": [8, 40], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/rds/main.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "final_snapshot_prefix", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "snapshot_identifier": [{"type": "variable", "name": "restore_snapshot_identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "engine_version": [{"type": "variable", "name": "engine_version", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "deletion_protection": [{"type": "variable", "name": "deletion_protection", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "enabled_cloudwatch_logs_exports": [{"type": "variable", "name": "enabled_cloudwatch_logs_exports", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "db_name": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_name", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "max_allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "max_allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_interval": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "username": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_username", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_role_arn": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "multi_az": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "multi_az", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "instance_class": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "instance_class", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "tags", "path": "/work/modules/rds/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "idx": 151, "source_module_object": null}]}}, {"check_id": "CKV_AWS_353", "bc_check_id": "BC_AWS_LOGGING_47", "check_name": "Ensure that RDS instances have performance insights enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["performance_insights_enabled"]}, "code_block": null, "file_path": "/../../modules/rds/main.tf", "file_abs_path": "/work/modules/rds/main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [131, 191], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerformanceInsights", "fixed_definition": null, "entity_tags": {"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": "/rds.tf", "caller_file_line_range": [8, 40], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-353", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/rds/main.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "final_snapshot_prefix", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "snapshot_identifier": [{"type": "variable", "name": "restore_snapshot_identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "engine_version": [{"type": "variable", "name": "engine_version", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "deletion_protection": [{"type": "variable", "name": "deletion_protection", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "enabled_cloudwatch_logs_exports": [{"type": "variable", "name": "enabled_cloudwatch_logs_exports", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "db_name": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_name", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "max_allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "max_allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_interval": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "username": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_username", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_role_arn": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "multi_az": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "multi_az", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "instance_class": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "instance_class", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "tags", "path": "/work/modules/rds/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "idx": 151, "source_module_object": null}]}}, {"check_id": "CKV_AWS_374", "bc_check_id": "BC_AWS_NETWORKING_97", "check_name": "Ensure AWS CloudFront web distribution has geo restriction enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrictions/[0]/geo_restriction/[0]/restriction_type"]}, "code_block": null, "file_path": "/../../modules/redirect_domain/main.tf", "file_abs_path": "/work/modules/redirect_domain/main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 178], "resource": "module.redirect_mwc_prod.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontGeoRestrictionDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/redirect.tf", "caller_file_line_range": [1, 25], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/redirect_domain/main.tf", "breadcrumbs": {"price_class": [{"type": "variable", "name": "price_class", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "aliases": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "from_domains", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content.prefix": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content.bucket": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.for_each": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "idx": 155, "source_module_object": null}]}}, {"check_id": "CKV_AWS_310", "bc_check_id": "BC_AWS_GENERAL_222", "check_name": "Ensure CloudFront distributions should have origin failover configured", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": null, "file_path": "/../../modules/redirect_domain/main.tf", "file_abs_path": "/work/modules/redirect_domain/main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 178], "resource": "module.redirect_mwc_prod.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionOriginFailover", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/redirect.tf", "caller_file_line_range": [1, 25], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/redirect_domain/main.tf", "breadcrumbs": {"price_class": [{"type": "variable", "name": "price_class", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "aliases": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "from_domains", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content.prefix": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content.bucket": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.for_each": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "idx": 155, "source_module_object": null}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": null, "file_path": "/../../modules/vpc/endpoints/main.tf", "file_abs_path": "/work/modules/vpc/endpoints/main.tf", "repo_file_path": "/modules/vpc/endpoints/main.tf", "file_line_range": [16, 43], "resource": "module.vpc_endpoints.aws_security_group.vpce", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual", "Purpose": "VpcEndpoints"}, "caller_file_path": "/main.tf", "caller_file_line_range": [27, 53], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/vpc/endpoints/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "vpc_endpoints", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/work/modules/vpc/endpoints/variables.tf", "module_connection": false}], "dynamic.ingress.for_each": [{"type": "module", "name": "vpc_endpoints", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "allow_from_vpc_cidr", "path": "/work/modules/vpc/endpoints/variables.tf", "module_connection": false}], "dynamic.ingress": [{"type": "module", "name": "vpc_endpoints", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "allow_from_vpc_cidr", "path": "/work/modules/vpc/endpoints/variables.tf", "module_connection": false}], "vpc_id": [{"type": "module", "name": "vpc_endpoints", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/work/modules/vpc/endpoints/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "security_group_name", "path": "/work/modules/vpc/endpoints/variables.tf", "module_connection": false}, {"type": "locals", "name": "sg_name", "path": "/work/modules/vpc/endpoints/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "vpc_endpoints", "path": "/work/envs/prod/main.tf", "idx": 91, "source_module_object": null}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": null, "file_path": "/../../modules/vpc/main.tf", "file_abs_path": "/work/modules/vpc/main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [44, 51], "resource": "module.vpc.aws_subnet.public", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Env": "prod", "Project": "spiritual", "Name": "sf-prod-public-each.key"}, "caller_file_path": "/main.tf", "caller_file_line_range": [11, 25], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/vpc/main.tf", "breadcrumbs": {"for_each": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "public_subnet_cidrs", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "availability_zone": [{"type": "locals", "name": "azs", "path": "/work/modules/vpc/main.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "tags", "path": "/work/modules/vpc/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "idx": 90, "source_module_object": null}]}}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": null, "file_path": "/../../modules/vpc/main.tf", "file_abs_path": "/work/modules/vpc/main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [133, 143], "resource": "module.vpc.aws_cloudwatch_log_group.vpc_flow[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Env": "prod", "Project": "spiritual", "Name": "sf-prod-vpc-flow-logs"}, "caller_file_path": "/main.tf", "caller_file_line_range": [11, 25], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/vpc/main.tf", "breadcrumbs": {"kms_key_id": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "flow_logs_kms_key_arn", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "retention_in_days": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "flow_logs_retention_days", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "tags", "path": "/work/modules/vpc/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "idx": 90, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"this[0]": {"__end_line__": 28, "__start_line__": 20, "cidr_block": ["10.1.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": ["True"], "__address__": "module.vpc.aws_vpc.this[0]"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": null, "file_path": "/../../modules/vpc/main.tf", "file_abs_path": "/work/modules/vpc/main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [20, 28], "resource": "module.vpc.aws_vpc.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "True", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/vpc/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "cidr_block": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "cidr_block", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "idx": 90, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"rds[0]": {"__end_line__": 42, "__start_line__": 36, "description": ["Allow Postgres from app runner + ecs + (optional) admin"], "name": ["sf-prod-rds-sg"], "tags": [{"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual", "Name": "sf-prod-rds-sg"}], "vpc_id": ["aws_vpc.this[0].id"], "__address__": "module.rds.aws_security_group.rds[0]"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": null, "file_path": "/../../modules/rds/main.tf", "file_abs_path": "/work/modules/rds/main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [36, 42], "resource": "module.rds.aws_security_group.rds[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual", "Name": "sf-prod-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/rds/main.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "tags", "path": "/work/modules/rds/main.tf", "module_connection": false}], "name": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "vpc_id": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "vpc_id", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "idx": 151, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_30", "bc_check_id": "BC_AWS_LOGGING_32", "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_db_instance": {"this[0]": {"__end_line__": 191, "__start_line__": 131, "allocated_storage": [20], "apply_immediately": [true], "auto_minor_version_upgrade": [true], "backup_retention_period": [3], "backup_window": ["22:00-23:00"], "copy_tags_to_snapshot": [true], "db_name": ["app"], "db_subnet_group_name": ["aws_db_subnet_group.this[0].name"], "deletion_protection": [false], "depends_on": [["aws_db_parameter_group.pg", "aws_db_subnet_group.this"]], "enabled_cloudwatch_logs_exports": [["postgresql"]], "engine": ["postgres"], "engine_version": ["16.8"], "final_snapshot_identifier": ["sf-prod-final-${replace(${timestamp()}, \":\", \"-\")}"], "identifier": ["True"], "instance_class": ["db.t4g.micro"], "maintenance_window": ["Mon:00:00-Mon:01:00"], "max_allocated_storage": [100], "monitoring_interval": [15], "monitoring_role_arn": ["aws_iam_role.rds_em.arn"], "multi_az": [true], "parameter_group_name": ["aws_db_parameter_group.pg[0].name"], "password": ["random_password.db.result"], "performance_insights_enabled": [false], "publicly_accessible": [false], "skip_final_snapshot": [false], "snapshot_identifier": ["True"], "storage_encrypted": [true], "tags": [{"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}], "username": ["appuser"], "vpc_security_group_ids": [["aws_security_group.rds[0].id"]], "__address__": "module.rds.aws_db_instance.this[0]"}}}, "evaluated_keys": ["resource_type", "engine", "parameter/*/name"]}, "code_block": null, "file_path": "/../../modules/rds/main.tf", "file_abs_path": "/work/modules/rds/main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [131, 191], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/rds/main.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "final_snapshot_prefix", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "snapshot_identifier": [{"type": "variable", "name": "restore_snapshot_identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "engine_version": [{"type": "variable", "name": "engine_version", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "deletion_protection": [{"type": "variable", "name": "deletion_protection", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "enabled_cloudwatch_logs_exports": [{"type": "variable", "name": "enabled_cloudwatch_logs_exports", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "db_name": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_name", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "max_allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "max_allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_interval": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "allocated_storage": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "allocated_storage_gb", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "username": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "db_username", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "identifier": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "identifier", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "monitoring_role_arn": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "monitoring_interval", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "multi_az": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "multi_az", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "instance_class": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "module_connection": false}, {"type": "variable", "name": "instance_class", "path": "/work/modules/rds/variables.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "tags", "path": "/work/modules/rds/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "rds", "path": "/work/envs/prod/rds.tf", "idx": 151, "source_module_object": null}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"cloudtrail": {"__end_line__": 16, "__start_line__": 13, "bucket": ["sf-prod-us-east-1-${data.aws_caller_identity.acct.account_id}-cloudtrail"], "tags": [{"Env": "prod", "Managed": "Terraform", "Project": "spiritual", "Purpose": "CloudTrailLogs"}], "__address__": "aws_s3_bucket.cloudtrail"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "/cloudtrail.tf", "file_abs_path": "/work/envs/prod/cloudtrail.tf", "repo_file_path": "/envs/prod/cloudtrail.tf", "file_line_range": [13, 16], "resource": "aws_s3_bucket.cloudtrail", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual", "Purpose": "CloudTrailLogs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/cloudtrail.tf", "breadcrumbs": {"tags.Env": [{"type": "tfvar", "name": "env", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "tags.Project": [{"type": "tfvar", "name": "project", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/envs/prod/variables.tf", "module_connection": false}], "bucket": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"waf_logs": {"__end_line__": 158, "__start_line__": 156, "bucket": ["sf-prod-waf-logs"], "__address__": "aws_s3_bucket.waf_logs"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "/waf.tf", "file_abs_path": "/work/envs/prod/waf.tf", "repo_file_path": "/envs/prod/waf.tf", "file_line_range": [156, 158], "resource": "aws_s3_bucket.waf_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/envs/prod/waf.tf", "breadcrumbs": {"bucket": [{"type": "tfvar", "name": "name_prefix", "path": "/work/envs/prod/terraform.tfvars", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/envs/prod/variables.tf", "module_connection": false}, {"type": "locals", "name": "lambda_name", "path": "/work/envs/prod/secret_rotation_bridge.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.rds_em", "path": "/work/envs/prod/rds_enhanced_monitoring.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.sm_rotation", "path": "/work/envs/prod/secret_rotation.tf", "module_connection": false}, {"type": "resource", "name": "aws_cloudwatch_event_rule.diag_sm", "path": "/work/envs/prod/eventbridge_diag.tf", "module_connection": false}, {"type": "locals", "name": "ct_bucket_name", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.cloudtrail", "path": "/work/envs/prod/cloudtrail.tf", "module_connection": false}, {"type": "resource", "name": "aws_wafv2_web_acl.prod", "path": "/work/envs/prod/waf.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"site": {"__end_line__": 26, "__start_line__": 19, "bucket": ["local.bucket_name"], "tags": [{"Environment": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}], "__address__": "module.frontend_site_prod.aws_s3_bucket.site"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "/../../modules/cloudfront_site/main.tf", "file_abs_path": "/work/modules/cloudfront_site/main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [19, 26], "resource": "module.frontend_site_prod.aws_s3_bucket.site", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/cloudfront_site/main.tf", "breadcrumbs": {"tags.Project": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "idx": 86, "source_module_object": null}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 14, "__start_line__": 9, "bucket": ["True"], "force_destroy": [false], "tags": [{"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}], "__address__": "module.logging.aws_s3_bucket.logs"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "/../../modules/logging/main.tf", "file_abs_path": "/work/modules/logging/main.tf", "repo_file_path": "/modules/logging/main.tf", "file_line_range": [9, 14], "resource": "module.logging.aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "prod", "Managed": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/logging/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "logging", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/work/modules/logging/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "logging", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/logging/variables.tf", "module_connection": false}, {"type": "locals", "name": "bucket_name", "path": "/work/modules/logging/main.tf", "module_connection": false}, {"type": "resource", "name": "aws_s3_bucket.logs", "path": "/work/modules/logging/main.tf", "module_connection": false}, {"type": "output", "name": "log_bucket_name", "path": "/work/modules/logging/outputs.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "logging", "path": "/work/envs/prod/main.tf", "idx": 92, "source_module_object": null}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"metadata": {"__end_line__": 15, "__start_line__": 12, "bucket": ["local.metadata_bucket_name"], "tags": ["local.tags"], "__address__": "module.s3.aws_s3_bucket.metadata"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "/../../modules/s3/main.tf", "file_abs_path": "/work/modules/s3/main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [12, 15], "resource": "module.s3.aws_s3_bucket.metadata", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "local.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/s3/main.tf", "breadcrumbs": {"source_module_": [{"type": "module", "name": "s3", "path": "/work/envs/prod/s3.tf", "idx": 159, "source_module_object": null}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"frontend": {"__end_line__": 141, "__start_line__": 137, "bucket": ["local.frontend_bucket_name"], "count": ["var.create_frontend_bucket ? 1 : 0"], "tags": ["local.tags"], "__address__": "module.s3.aws_s3_bucket.frontend"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "/../../modules/s3/main.tf", "file_abs_path": "/work/modules/s3/main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [137, 141], "resource": "module.s3.aws_s3_bucket.frontend", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "local.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/s3/main.tf", "breadcrumbs": {"source_module_": [{"type": "module", "name": "s3", "path": "/work/envs/prod/s3.tf", "idx": 159, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"this[0]": {"__end_line__": 28, "__start_line__": 20, "cidr_block": ["10.1.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": ["True"], "__address__": "module.vpc.aws_vpc.this[0]"}}}, "evaluated_keys": ["ingress/from_port", "ingress/to_port", "ingress/protocol", "egress/to_port", "ingress/self", "egress/cidr_blocks", "egress/from_port", "resource_type", "egress/protocol"]}, "code_block": null, "file_path": "/../../modules/vpc/main.tf", "file_abs_path": "/work/modules/vpc/main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [20, 28], "resource": "module.vpc.aws_vpc.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "True", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/vpc/main.tf", "breadcrumbs": {"tags": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "cidr_block": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "module_connection": false}, {"type": "variable", "name": "cidr_block", "path": "/work/modules/vpc/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "vpc", "path": "/work/envs/prod/main.tf", "idx": 90, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_api_prod.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "/../../modules/route53_acm/main.tf", "file_abs_path": "/work/modules/route53_acm/main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_api_prod.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/route53_acm/main.tf", "breadcrumbs": {"name": [{"type": "module", "name": "route53_acm_api_prod", "path": "/work/envs/prod/route53_acm_api.tf", "module_connection": false}, {"type": "variable", "name": "root_domain_name", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}], "count": [{"type": "module", "name": "route53_acm_api_prod", "path": "/work/envs/prod/route53_acm_api.tf", "module_connection": false}, {"type": "variable", "name": "manage_zone", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}, {"type": "locals", "name": "zone_id", "path": "/work/modules/route53_acm/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "route53_acm_api_prod", "path": "/work/envs/prod/route53_acm_api.tf", "idx": 156, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_frontend_prod.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "/../../modules/route53_acm/main.tf", "file_abs_path": "/work/modules/route53_acm/main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_frontend_prod.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/route53_acm/main.tf", "breadcrumbs": {"name": [{"type": "module", "name": "route53_acm_frontend_prod", "path": "/work/envs/prod/route53_acm_frontend.tf", "module_connection": false}, {"type": "variable", "name": "root_domain_name", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}], "count": [{"type": "module", "name": "route53_acm_frontend_prod", "path": "/work/envs/prod/route53_acm_frontend.tf", "module_connection": false}, {"type": "variable", "name": "manage_zone", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}, {"type": "locals", "name": "zone_id", "path": "/work/modules/route53_acm/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "route53_acm_frontend_prod", "path": "/work/envs/prod/route53_acm_frontend.tf", "idx": 157, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_static_prod.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "/../../modules/route53_acm/main.tf", "file_abs_path": "/work/modules/route53_acm/main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_static_prod.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/route53_acm/main.tf", "breadcrumbs": {"name": [{"type": "module", "name": "route53_acm_static_prod", "path": "/work/envs/prod/route53_acm_static.tf", "module_connection": false}, {"type": "variable", "name": "root_domain_name", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}], "count": [{"type": "module", "name": "route53_acm_static_prod", "path": "/work/envs/prod/route53_acm_static.tf", "module_connection": false}, {"type": "variable", "name": "manage_zone", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}, {"type": "locals", "name": "zone_id", "path": "/work/modules/route53_acm/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "route53_acm_static_prod", "path": "/work/envs/prod/route53_acm_static.tf", "idx": 158, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_api_prod.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "/../../modules/route53_acm/main.tf", "file_abs_path": "/work/modules/route53_acm/main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_api_prod.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/route53_acm/main.tf", "breadcrumbs": {"name": [{"type": "module", "name": "route53_acm_api_prod", "path": "/work/envs/prod/route53_acm_api.tf", "module_connection": false}, {"type": "variable", "name": "root_domain_name", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}], "count": [{"type": "module", "name": "route53_acm_api_prod", "path": "/work/envs/prod/route53_acm_api.tf", "module_connection": false}, {"type": "variable", "name": "manage_zone", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}, {"type": "locals", "name": "zone_id", "path": "/work/modules/route53_acm/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "route53_acm_api_prod", "path": "/work/envs/prod/route53_acm_api.tf", "idx": 156, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_frontend_prod.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "/../../modules/route53_acm/main.tf", "file_abs_path": "/work/modules/route53_acm/main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_frontend_prod.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/route53_acm/main.tf", "breadcrumbs": {"name": [{"type": "module", "name": "route53_acm_frontend_prod", "path": "/work/envs/prod/route53_acm_frontend.tf", "module_connection": false}, {"type": "variable", "name": "root_domain_name", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}], "count": [{"type": "module", "name": "route53_acm_frontend_prod", "path": "/work/envs/prod/route53_acm_frontend.tf", "module_connection": false}, {"type": "variable", "name": "manage_zone", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}, {"type": "locals", "name": "zone_id", "path": "/work/modules/route53_acm/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "route53_acm_frontend_prod", "path": "/work/envs/prod/route53_acm_frontend.tf", "idx": 157, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_static_prod.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "/../../modules/route53_acm/main.tf", "file_abs_path": "/work/modules/route53_acm/main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_static_prod.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/route53_acm/main.tf", "breadcrumbs": {"name": [{"type": "module", "name": "route53_acm_static_prod", "path": "/work/envs/prod/route53_acm_static.tf", "module_connection": false}, {"type": "variable", "name": "root_domain_name", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}], "count": [{"type": "module", "name": "route53_acm_static_prod", "path": "/work/envs/prod/route53_acm_static.tf", "module_connection": false}, {"type": "variable", "name": "manage_zone", "path": "/work/modules/route53_acm/variables.tf", "module_connection": false}, {"type": "locals", "name": "zone_id", "path": "/work/modules/route53_acm/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "route53_acm_static_prod", "path": "/work/envs/prod/route53_acm_static.tf", "idx": 158, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_32", "bc_check_id": "BC_AWS_NETWORKING_65", "check_name": "Ensure CloudFront distribution has a response headers policy attached", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"this": {"__end_line__": 188, "__start_line__": 110, "aliases": [["www.catholicmentalprayer.com"]], "comment": ["www.catholicmentalprayer.com"], "default_cache_behavior": [{"allowed_methods": [[["GET"], ["HEAD"], ["OPTIONS"]]], "cached_methods": [[["GET"], ["HEAD"]]], "default_ttl": [3600], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "max_ttl": [86400], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["s3-origin-www.catholicmentalprayer.com"], "viewer_protocol_policy": ["redirect-to-https"]}], "default_root_object": ["index.html"], "dynamic": [{"custom_error_response": [{"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}, {"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}]}], "enabled": [true], "is_ipv6_enabled": [true], "logging_config": [{"bucket": ["None"], "include_cookies": [false], "prefix": ["cloudfront/www.catholicmentalprayer.com/"]}], "origin": [{"domain_name": ["aws_s3_bucket.site.bucket_regional_domain_name"], "origin_id": ["s3-origin-www.catholicmentalprayer.com"], "s3_origin_config": [{"origin_access_identity": ["aws_cloudfront_origin_access_identity.oai.cloudfront_access_identity_path"]}]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"locations": [], "restriction_type": ["none"]}]}], "tags": [{"Environment": ["prod"], "ManagedBy": ["Terraform"], "Project": ["spiritual"]}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "web_acl_id": ["aws_wafv2_web_acl.prod.arn"], "__address__": "module.frontend_site_prod.aws_cloudfront_distribution.this", "__provider_address__": "", "custom_error_response": [{"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}, {"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}]}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "/../../modules/cloudfront_site/main.tf", "file_abs_path": "/work/modules/cloudfront_site/main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [110, 188], "resource": "module.frontend_site_prod.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/cloudfront_site/main.tf", "breadcrumbs": {"restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.default_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "default_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "viewer_certificate.acm_certificate_arn": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "acm_certificate_arn", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "logging_config.bucket": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "tags.Project": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "aliases": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "dynamic.custom_error_response.for_each": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "custom_error_response.error_code": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "dynamic.custom_error_response": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "spa_mode", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.target_origin_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "origin.origin_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.min_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "min_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "logging_config.prefix": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "comment": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "default_cache_behavior.max_ttl": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "max_ttl", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "price_class": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "price_class", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/modules/cloudfront_site/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "frontend_site_prod", "path": "/work/envs/prod/frontend.tf", "idx": 86, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_32", "bc_check_id": "BC_AWS_NETWORKING_65", "check_name": "Ensure CloudFront distribution has a response headers policy attached", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"static": {"__end_line__": 94, "__start_line__": 26, "aliases": [["static.catholicmentalprayer.com"]], "comment": ["Static assets for static.catholicmentalprayer.com"], "default_cache_behavior": [{"allowed_methods": [["GET", "HEAD", "OPTIONS"]], "cached_methods": [["GET", "HEAD"]], "default_ttl": [86400], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "max_ttl": [604800], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.static_cors.id"], "target_origin_id": ["s3-spiritual-formation-prod"], "viewer_protocol_policy": ["redirect-to-https"]}], "default_root_object": [""], "enabled": [true], "is_ipv6_enabled": [true], "logging_config": [{"bucket": ["None"], "include_cookies": [false], "prefix": ["cloudfront/static.catholicmentalprayer.com/"]}], "origin": [{"domain_name": ["spiritual-formation-prod.s3.us-east-1.amazonaws.com"], "origin_access_control_id": ["aws_cloudfront_origin_access_control.oac.id"], "origin_id": ["s3-spiritual-formation-prod"], "origin_path": [""]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"locations": ["CN", "RU"], "restriction_type": ["blacklist"]}]}], "tags": [{"Environment": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "web_acl_id": ["aws_wafv2_web_acl.prod.arn"], "__address__": "module.static_admin_prod.aws_cloudfront_distribution.static", "__provider_address__": ""}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "/../../modules/cloudfront_static/main.tf", "file_abs_path": "/work/modules/cloudfront_static/main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 94], "resource": "module.static_admin_prod.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "ManagedBy": "Terraform", "Project": "spiritual"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/cloudfront_static/main.tf", "breadcrumbs": {"aliases": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.domain_name": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.min_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "min_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "comment": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.origin_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "env", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.max_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "max_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.default_ttl": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "default_ttl", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "tags.Project": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "origin.origin_path": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "origin_path", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "logging_config.prefix": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "domain_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "price_class": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "price_class", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "default_cache_behavior.target_origin_id": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "viewer_certificate.acm_certificate_arn": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "acm_certificate_arn", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "logging_config.bucket": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/cloudfront_static/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "static_admin_prod", "path": "/work/envs/prod/static_admin.tf", "idx": 190, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_32", "bc_check_id": "BC_AWS_NETWORKING_65", "check_name": "Ensure CloudFront distribution has a response headers policy attached", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"this": {"__end_line__": 178, "__start_line__": 108, "aliases": [["meditationwithchrist.com", "www.meditationwithchrist.com"]], "comment": ["local.comment"], "default_cache_behavior": [{"allowed_methods": [["GET", "HEAD"]], "cached_methods": [["GET", "HEAD"]], "default_ttl": [300], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "function_association": [{"event_type": ["viewer-request"], "function_arn": ["aws_cloudfront_function.redirect.arn"]}], "max_ttl": [300], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["dummy-origin"], "viewer_protocol_policy": ["redirect-to-https"]}], "dynamic": [{"logging_config": {"content": [{"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}], "for_each": []}}], "enabled": [true], "is_ipv6_enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_keepalive_timeout": [5], "origin_protocol_policy": ["https-only"], "origin_read_timeout": [30], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["example.com"], "origin_id": ["dummy-origin"]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"locations": [], "restriction_type": ["none"]}]}], "tags": ["local.tags"], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate_validation.cert.certificate_arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "wait_for_deployment": [true], "web_acl_id": ["aws_wafv2_web_acl.prod.arn"], "__address__": "module.redirect_mwc_prod.aws_cloudfront_distribution.this", "__provider_address__": "", "logging_config": [{"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}, {"bucket": ["True.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-prod-redirect/"]}]}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "/../../modules/redirect_domain/main.tf", "file_abs_path": "/work/modules/redirect_domain/main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 178], "resource": "module.redirect_mwc_prod.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "local.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65", "details": [], "check_len": null, "definition_context_file_path": "/work/modules/redirect_domain/main.tf", "breadcrumbs": {"price_class": [{"type": "variable", "name": "price_class", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "web_acl_id": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "web_acl_arn", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "default_cache_behavior.response_headers_policy_id": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "response_headers_policy_id", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "aliases": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "from_domains", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction.restriction_type": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_restriction_type", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "restrictions.geo_restriction.locations": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "geo_locations", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content.prefix": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "name_prefix", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.content.bucket": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "dynamic.logging_config.for_each": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "module_connection": false}, {"type": "variable", "name": "log_bucket_name", "path": "/work/modules/redirect_domain/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "redirect_mwc_prod", "path": "/work/envs/prod/redirect.tf", "idx": 155, "source_module_object": null}]}}]}, "summary": {"passed": 713, "failed": 43, "skipped": 14, "parsing_errors": 0, "resource_count": 211, "checkov_version": "3.2.466"}}