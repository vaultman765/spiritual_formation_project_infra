{"check_type": "terraform", "results": {"failed_checks": [{"check_id": "CKV_AWS_119", "bc_check_id": "BC_AWS_GENERAL_52", "check_name": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["server_side_encryption/[0]/enabled", "server_side_encryption/[0]/kms_key_arn"]}, "code_block": null, "file_path": "\\bootstrap\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf", "repo_file_path": "/bootstrap/main.tf", "file_line_range": [28, 47], "resource": "aws_dynamodb_table.lock", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DynamoDBTablesEncrypted", "fixed_definition": null, "entity_tags": {"Env": "${var.env}", "Project": "${var.project}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["from_port", "to_port", "cidr_blocks", "ipv6_cidr_blocks"]}, "code_block": null, "file_path": "\\envs\\staging\\security-groups.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\envs\\staging\\security-groups.tf", "repo_file_path": "/envs/staging/security-groups.tf", "file_line_range": [25, 33], "resource": "aws_security_group_rule.ecs_tasks_egress_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\envs\\staging\\security-groups.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": null, "file_path": "\\modules\\apprunner\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\apprunner\\main.tf", "repo_file_path": "/modules/apprunner/main.tf", "file_line_range": [9, 13], "resource": "module.apprunner.aws_cloudwatch_log_group.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\apprunner.tf", "caller_file_line_range": [1, 64], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\apprunner\\main.tf"}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": ["description", "egress/[0]"]}, "code_block": null, "file_path": "\\modules\\apprunner\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\apprunner\\main.tf", "repo_file_path": "/modules/apprunner/main.tf", "file_line_range": [16, 27], "resource": "module.apprunner.aws_security_group.apprunner", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\apprunner.tf", "caller_file_line_range": [1, 64], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\apprunner\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": null, "file_path": "\\modules\\apprunner\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\apprunner\\main.tf", "repo_file_path": "/modules/apprunner/main.tf", "file_line_range": [16, 27], "resource": "module.apprunner.aws_security_group.apprunner", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\apprunner.tf", "caller_file_line_range": [1, 64], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\apprunner\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": null, "file_path": "\\modules\\client_vpn\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf", "repo_file_path": "/modules/client_vpn/main.tf", "file_line_range": [7, 12], "resource": "module.client_vpn.aws_cloudwatch_log_group.cvpn[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\vpn.tf", "caller_file_line_range": [1, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": null, "file_path": "\\modules\\client_vpn\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf", "repo_file_path": "/modules/client_vpn/main.tf", "file_line_range": [7, 12], "resource": "module.client_vpn.aws_cloudwatch_log_group.cvpn[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\vpn.tf", "caller_file_line_range": [1, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf"}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": ["description", "egress/[0]"]}, "code_block": null, "file_path": "\\modules\\client_vpn\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf", "repo_file_path": "/modules/client_vpn/main.tf", "file_line_range": [15, 26], "resource": "module.client_vpn.aws_security_group.cvpn", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\vpn.tf", "caller_file_line_range": [1, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": null, "file_path": "\\modules\\client_vpn\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf", "repo_file_path": "/modules/client_vpn/main.tf", "file_line_range": [15, 26], "resource": "module.client_vpn.aws_security_group.cvpn", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\vpn.tf", "caller_file_line_range": [1, 11], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\client_vpn\\main.tf"}, {"check_id": "CKV_AWS_310", "bc_check_id": "BC_AWS_GENERAL_222", "check_name": "Ensure CloudFront distributions should have origin failover configured", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": null, "file_path": "\\modules\\cloudfront_site\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [99, 171], "resource": "module.frontend_staging.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionOriginFailover", "fixed_definition": null, "entity_tags": {"Environment": ["staging"], "ManagedBy": ["Terraform"], "Project": ["spiritual-formation"]}, "caller_file_path": "\\envs\\staging\\frontend.tf", "caller_file_line_range": [5, 32], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf"}, {"check_id": "CKV_AWS_374", "bc_check_id": "BC_AWS_NETWORKING_97", "check_name": "Ensure AWS CloudFront web distribution has geo restriction enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrictions/[0]/geo_restriction/[0]/restriction_type"]}, "code_block": null, "file_path": "\\modules\\cloudfront_site\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [99, 171], "resource": "module.frontend_staging.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontGeoRestrictionDisabled", "fixed_definition": null, "entity_tags": {"Environment": ["staging"], "ManagedBy": ["Terraform"], "Project": ["spiritual-formation"]}, "caller_file_path": "\\envs\\staging\\frontend.tf", "caller_file_line_range": [5, 32], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf"}, {"check_id": "CKV_AWS_68", "bc_check_id": "BC_AWS_GENERAL_27", "check_name": "CloudFront Distribution should have WAF enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["web_acl_id"]}, "code_block": null, "file_path": "\\modules\\cloudfront_site\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [99, 171], "resource": "module.frontend_staging.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFEnabled", "fixed_definition": null, "entity_tags": {"Environment": ["staging"], "ManagedBy": ["Terraform"], "Project": ["spiritual-formation"]}, "caller_file_path": "\\envs\\staging\\frontend.tf", "caller_file_line_range": [5, 32], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-27", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf"}, {"check_id": "CKV_AWS_305", "bc_check_id": "BC_AWS_GENERAL_219", "check_name": "Ensure CloudFront distribution has a default root object configured", "check_result": {"result": "FAILED", "evaluated_keys": ["default_root_object"]}, "code_block": null, "file_path": "\\modules\\cloudfront_static\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 90], "resource": "module.static_admin_staging.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionDefaultRoot", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\static_admin.tf", "caller_file_line_range": [6, 32], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-305", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf"}, {"check_id": "CKV_AWS_310", "bc_check_id": "BC_AWS_GENERAL_222", "check_name": "Ensure CloudFront distributions should have origin failover configured", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": null, "file_path": "\\modules\\cloudfront_static\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 90], "resource": "module.static_admin_staging.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionOriginFailover", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\static_admin.tf", "caller_file_line_range": [6, 32], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf"}, {"check_id": "CKV_AWS_374", "bc_check_id": "BC_AWS_NETWORKING_97", "check_name": "Ensure AWS CloudFront web distribution has geo restriction enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrictions/[0]/geo_restriction/[0]/restriction_type"]}, "code_block": null, "file_path": "\\modules\\cloudfront_static\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 90], "resource": "module.static_admin_staging.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontGeoRestrictionDisabled", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\static_admin.tf", "caller_file_line_range": [6, 32], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf"}, {"check_id": "CKV_AWS_68", "bc_check_id": "BC_AWS_GENERAL_27", "check_name": "CloudFront Distribution should have WAF enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["web_acl_id"]}, "code_block": null, "file_path": "\\modules\\cloudfront_static\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 90], "resource": "module.static_admin_staging.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFEnabled", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": "\\envs\\staging\\static_admin.tf", "caller_file_line_range": [6, 32], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-27", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf"}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["image_tag_mutability"]}, "code_block": null, "file_path": "\\modules\\ecr\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecr\\main.tf", "repo_file_path": "/modules/ecr/main.tf", "file_line_range": [1, 6], "resource": "module.ecr_backend.aws_ecr_repository.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\ecr.tf", "caller_file_line_range": [1, 4], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecr\\main.tf"}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["encryption_configuration/[0]/encryption_type"]}, "code_block": null, "file_path": "\\modules\\ecr\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecr\\main.tf", "repo_file_path": "/modules/ecr/main.tf", "file_line_range": [1, 6], "resource": "module.ecr_backend.aws_ecr_repository.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\ecr.tf", "caller_file_line_range": [1, 4], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecr\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": null, "file_path": "\\modules\\ecs_import_job\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecs_import_job\\main.tf", "repo_file_path": "/modules/ecs_import_job/main.tf", "file_line_range": [17, 21], "resource": "module.ecs_import.aws_cloudwatch_log_group.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\eventbridge-import.tf", "caller_file_line_range": [5, 19], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecs_import_job\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": null, "file_path": "\\modules\\ecs_import_job\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecs_import_job\\main.tf", "repo_file_path": "/modules/ecs_import_job/main.tf", "file_line_range": [17, 21], "resource": "module.ecs_import.aws_cloudwatch_log_group.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\eventbridge-import.tf", "caller_file_line_range": [5, 19], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\ecs_import_job\\main.tf"}, {"check_id": "CKV_AWS_149", "bc_check_id": "BC_AWS_GENERAL_79", "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [114, 117], "resource": "module.rds.aws_secretsmanager_secret.db", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_226", "bc_check_id": "BC_AWS_GENERAL_121", "check_name": "Ensure DB instance gets all minor upgrades automatically", "check_result": {"result": "FAILED", "evaluated_keys": ["auto_minor_version_upgrade"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [120, 177], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceMinorUpgrade", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_118", "bc_check_id": "BC_AWS_LOGGING_28", "check_name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring_interval"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [120, 177], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEnhancedMonitorEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_161", "bc_check_id": "BC_AWS_IAM_65", "check_name": "Ensure RDS database has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [120, 177], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_293", "bc_check_id": "BC_AWS_GENERAL_208", "check_name": "Ensure that AWS database instances have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [120, 177], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstanceDeletionProtection", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_353", "bc_check_id": "BC_AWS_LOGGING_47", "check_name": "Ensure that RDS instances have performance insights enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["performance_insights_enabled"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [120, 177], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerformanceInsights", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-353", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_157", "bc_check_id": "BC_AWS_GENERAL_73", "check_name": "Ensure that RDS instances have Multi-AZ enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["multi_az"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [120, 177], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSMultiAZEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": null, "file_path": "\\modules\\rds\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [209, 213], "resource": "module.rds.aws_cloudwatch_log_group.rds_postgresql[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": "\\envs\\staging\\rds.tf", "caller_file_line_range": [9, 38], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV_AWS_310", "bc_check_id": "BC_AWS_GENERAL_222", "check_name": "Ensure CloudFront distributions should have origin failover configured", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": null, "file_path": "\\modules\\redirect_domain\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 174], "resource": "module.redirect_mwc.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionOriginFailover", "fixed_definition": null, "entity_tags": {"Project": ["spiritual-formation"], "Env": ["staging"], "ManagedBy": ["Terraform"]}, "caller_file_path": "\\envs\\staging\\redirect.tf", "caller_file_line_range": [1, 19], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf"}, {"check_id": "CKV_AWS_374", "bc_check_id": "BC_AWS_NETWORKING_97", "check_name": "Ensure AWS CloudFront web distribution has geo restriction enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrictions/[0]/geo_restriction/[0]/restriction_type"]}, "code_block": null, "file_path": "\\modules\\redirect_domain\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 174], "resource": "module.redirect_mwc.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontGeoRestrictionDisabled", "fixed_definition": null, "entity_tags": {"Project": ["spiritual-formation"], "Env": ["staging"], "ManagedBy": ["Terraform"]}, "caller_file_path": "\\envs\\staging\\redirect.tf", "caller_file_line_range": [1, 19], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf"}, {"check_id": "CKV_AWS_68", "bc_check_id": "BC_AWS_GENERAL_27", "check_name": "CloudFront Distribution should have WAF enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["web_acl_id"]}, "code_block": null, "file_path": "\\modules\\redirect_domain\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 174], "resource": "module.redirect_mwc.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFEnabled", "fixed_definition": null, "entity_tags": {"Project": ["spiritual-formation"], "Env": ["staging"], "ManagedBy": ["Terraform"]}, "caller_file_path": "\\envs\\staging\\redirect.tf", "caller_file_line_range": [1, 19], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-27", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf"}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": ["description", "egress/[0]", "ingress/[0]"]}, "code_block": null, "file_path": "\\modules\\vpc\\endpoints\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\endpoints\\main.tf", "repo_file_path": "/modules/vpc/endpoints/main.tf", "file_line_range": [16, 41], "resource": "module.vpc_endpoints.aws_security_group.vpce", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Env": ["staging"], "Managed": ["Terraform"], "Project": ["spiritual-formation"], "Purpose": ["VpcEndpoints"]}, "caller_file_path": "\\envs\\staging\\main.tf", "caller_file_line_range": [42, 76], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\endpoints\\main.tf"}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": null, "file_path": "\\modules\\vpc\\endpoints\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\endpoints\\main.tf", "repo_file_path": "/modules/vpc/endpoints/main.tf", "file_line_range": [16, 41], "resource": "module.vpc_endpoints.aws_security_group.vpce", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Env": ["staging"], "Managed": ["Terraform"], "Project": ["spiritual-formation"], "Purpose": ["VpcEndpoints"]}, "caller_file_path": "\\envs\\staging\\main.tf", "caller_file_line_range": [42, 76], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\endpoints\\main.tf"}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": null, "file_path": "\\modules\\vpc\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [37, 44], "resource": "module.vpc.aws_subnet.public", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Env": "staging", "Project": "spiritual-formation", "Name": "sf-staging-public-each.key"}, "caller_file_path": "\\envs\\staging\\main.tf", "caller_file_line_range": [20, 40], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": null, "file_path": "\\modules\\vpc\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [126, 136], "resource": "module.vpc.aws_cloudwatch_log_group.vpc_flow[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Env": "staging", "Project": "spiritual-formation", "Name": "sf-staging-vpc-flow-logs"}, "caller_file_path": "\\envs\\staging\\main.tf", "caller_file_line_range": [20, 40], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf"}, {"check_id": "CKV2_AWS_32", "bc_check_id": "BC_AWS_NETWORKING_65", "check_name": "Ensure CloudFront distribution has a response headers policy attached", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"this": {"__end_line__": 171, "__start_line__": 99, "aliases": [["staging.catholicmentalprayer.com"]], "comment": ["staging.catholicmentalprayer.com"], "default_cache_behavior": [{"allowed_methods": [[["GET"], ["HEAD"], ["OPTIONS"]]], "cached_methods": [[["GET"], ["HEAD"]]], "default_ttl": [3600], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "max_ttl": [86400], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["s3-origin-staging.catholicmentalprayer.com"], "viewer_protocol_policy": ["redirect-to-https"]}], "default_root_object": ["index.html"], "dynamic": [{"custom_error_response": [{"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}, {"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}]}], "enabled": [true], "is_ipv6_enabled": [true], "logging_config": [{"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/staging.catholicmentalprayer.com/"]}], "origin": [{"domain_name": ["aws_s3_bucket.site.bucket_regional_domain_name"], "origin_id": ["s3-origin-staging.catholicmentalprayer.com"], "s3_origin_config": [{"origin_access_identity": ["aws_cloudfront_origin_access_identity.oai.cloudfront_access_identity_path"]}]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"restriction_type": ["none"]}]}], "tags": [{"Environment": ["staging"], "ManagedBy": ["Terraform"], "Project": ["spiritual-formation"]}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "__address__": "module.frontend_staging.aws_cloudfront_distribution.this", "__provider_address__": "", "custom_error_response": [{"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}, {"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}]}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [99, 171], "resource": "module.frontend_staging.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf"}, {"check_id": "CKV2_AWS_32", "bc_check_id": "BC_AWS_NETWORKING_65", "check_name": "Ensure CloudFront distribution has a response headers policy attached", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"static": {"__end_line__": 90, "__start_line__": 26, "aliases": [["static.staging.catholicmentalprayer.com"]], "comment": ["Static assets for static.staging.catholicmentalprayer.com"], "default_cache_behavior": [{"allowed_methods": [["GET", "HEAD", "OPTIONS"]], "cached_methods": [["GET", "HEAD"]], "default_ttl": [86400], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "max_ttl": [604800], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["s3-spiritual-formation-staging"], "viewer_protocol_policy": ["redirect-to-https"]}], "default_root_object": [""], "enabled": [true], "is_ipv6_enabled": [true], "logging_config": [{"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/static.staging.catholicmentalprayer.com/"]}], "origin": [{"domain_name": ["spiritual-formation-staging.s3.us-east-1.amazonaws.com"], "origin_access_control_id": ["aws_cloudfront_origin_access_control.oac.id"], "origin_id": ["s3-spiritual-formation-staging"], "origin_path": [""]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"restriction_type": ["none"]}]}], "tags": [{"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "__address__": "module.static_admin_staging.aws_cloudfront_distribution.static", "__provider_address__": ""}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 90], "resource": "module.static_admin_staging.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf"}, {"check_id": "CKV2_AWS_32", "bc_check_id": "BC_AWS_NETWORKING_65", "check_name": "Ensure CloudFront distribution has a response headers policy attached", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"this": {"__end_line__": 174, "__start_line__": 108, "aliases": [[["staging.meditationwithchrist.com"], ["www.staging.meditationwithchrist.com"]]], "comment": ["True"], "default_cache_behavior": [{"allowed_methods": [[["GET"], ["HEAD"]]], "cached_methods": [[["GET"], ["HEAD"]]], "default_ttl": [300], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "function_association": [{"event_type": ["viewer-request"], "function_arn": ["aws_cloudfront_function.redirect.arn"]}], "max_ttl": [300], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["dummy-origin"], "viewer_protocol_policy": ["redirect-to-https"]}], "dynamic": [{"logging_config": {"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-staging-redirect/"]}}], "enabled": [true], "is_ipv6_enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_keepalive_timeout": [5], "origin_protocol_policy": ["https-only"], "origin_read_timeout": [30], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["example.com"], "origin_id": ["dummy-origin"]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"restriction_type": ["none"]}]}], "tags": [{"Project": ["spiritual-formation"], "Env": ["staging"], "ManagedBy": ["Terraform"]}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "wait_for_deployment": [true], "__address__": "module.redirect_mwc.aws_cloudfront_distribution.this", "__provider_address__": "", "logging_config": [{"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-staging-redirect/"]}]}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 174], "resource": "module.redirect_mwc.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Project": "spiritual-formation", "Env": "staging", "ManagedBy": "Terraform"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf"}, {"check_id": "CKV2_AWS_47", "bc_check_id": "BC_AWS_GENERAL_186", "check_name": "Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"this": {"__end_line__": 171, "__start_line__": 99, "aliases": [["staging.catholicmentalprayer.com"]], "comment": ["staging.catholicmentalprayer.com"], "default_cache_behavior": [{"allowed_methods": [[["GET"], ["HEAD"], ["OPTIONS"]]], "cached_methods": [[["GET"], ["HEAD"]]], "default_ttl": [3600], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "max_ttl": [86400], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["s3-origin-staging.catholicmentalprayer.com"], "viewer_protocol_policy": ["redirect-to-https"]}], "default_root_object": ["index.html"], "dynamic": [{"custom_error_response": [{"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}, {"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}]}], "enabled": [true], "is_ipv6_enabled": [true], "logging_config": [{"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/staging.catholicmentalprayer.com/"]}], "origin": [{"domain_name": ["aws_s3_bucket.site.bucket_regional_domain_name"], "origin_id": ["s3-origin-staging.catholicmentalprayer.com"], "s3_origin_config": [{"origin_access_identity": ["aws_cloudfront_origin_access_identity.oai.cloudfront_access_identity_path"]}]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"restriction_type": ["none"]}]}], "tags": [{"Environment": ["staging"], "ManagedBy": ["Terraform"], "Project": ["spiritual-formation"]}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "__address__": "module.frontend_staging.aws_cloudfront_distribution.this", "__provider_address__": "", "custom_error_response": [{"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}, {"error_caching_min_ttl": [0], "error_code": ["custom_error_response.value"], "response_code": [200], "response_page_path": ["/index.html"]}]}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [99, 171], "resource": "module.frontend_staging.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf"}, {"check_id": "CKV2_AWS_47", "bc_check_id": "BC_AWS_GENERAL_186", "check_name": "Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"static": {"__end_line__": 90, "__start_line__": 26, "aliases": [["static.staging.catholicmentalprayer.com"]], "comment": ["Static assets for static.staging.catholicmentalprayer.com"], "default_cache_behavior": [{"allowed_methods": [["GET", "HEAD", "OPTIONS"]], "cached_methods": [["GET", "HEAD"]], "default_ttl": [86400], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "max_ttl": [604800], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["s3-spiritual-formation-staging"], "viewer_protocol_policy": ["redirect-to-https"]}], "default_root_object": [""], "enabled": [true], "is_ipv6_enabled": [true], "logging_config": [{"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/static.staging.catholicmentalprayer.com/"]}], "origin": [{"domain_name": ["spiritual-formation-staging.s3.us-east-1.amazonaws.com"], "origin_access_control_id": ["aws_cloudfront_origin_access_control.oac.id"], "origin_id": ["s3-spiritual-formation-staging"], "origin_path": [""]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"restriction_type": ["none"]}]}], "tags": [{"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "__address__": "module.static_admin_staging.aws_cloudfront_distribution.static", "__provider_address__": ""}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf", "repo_file_path": "/modules/cloudfront_static/main.tf", "file_line_range": [26, 90], "resource": "module.static_admin_staging.aws_cloudfront_distribution.static", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_static\\main.tf"}, {"check_id": "CKV2_AWS_47", "bc_check_id": "BC_AWS_GENERAL_186", "check_name": "Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"this": {"__end_line__": 174, "__start_line__": 108, "aliases": [[["staging.meditationwithchrist.com"], ["www.staging.meditationwithchrist.com"]]], "comment": ["True"], "default_cache_behavior": [{"allowed_methods": [[["GET"], ["HEAD"]]], "cached_methods": [[["GET"], ["HEAD"]]], "default_ttl": [300], "forwarded_values": [{"cookies": [{"forward": ["none"]}], "query_string": [true]}], "function_association": [{"event_type": ["viewer-request"], "function_arn": ["aws_cloudfront_function.redirect.arn"]}], "max_ttl": [300], "min_ttl": [0], "response_headers_policy_id": ["aws_cloudfront_response_headers_policy.security.id"], "target_origin_id": ["dummy-origin"], "viewer_protocol_policy": ["redirect-to-https"]}], "dynamic": [{"logging_config": {"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-staging-redirect/"]}}], "enabled": [true], "is_ipv6_enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_keepalive_timeout": [5], "origin_protocol_policy": ["https-only"], "origin_read_timeout": [30], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["example.com"], "origin_id": ["dummy-origin"]}], "price_class": ["PriceClass_100"], "provider": ["aws.us_east_1"], "restrictions": [{"geo_restriction": [{"restriction_type": ["none"]}]}], "tags": [{"Project": ["spiritual-formation"], "Env": ["staging"], "ManagedBy": ["Terraform"]}], "viewer_certificate": [{"acm_certificate_arn": ["aws_acm_certificate.cert.arn"], "minimum_protocol_version": ["TLSv1.2_2021"], "ssl_support_method": ["sni-only"]}], "wait_for_deployment": [true], "__address__": "module.redirect_mwc.aws_cloudfront_distribution.this", "__provider_address__": "", "logging_config": [{"bucket": ["sf-staging-logs.s3.amazonaws.com"], "include_cookies": [false], "prefix": ["cloudfront/redirect/sf-staging-redirect/"]}]}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf", "repo_file_path": "/modules/redirect_domain/main.tf", "file_line_range": [108, 174], "resource": "module.redirect_mwc.aws_cloudfront_distribution.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Project": "spiritual-formation", "Env": "staging", "ManagedBy": "Terraform"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\redirect_domain\\main.tf"}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_api_staging.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_api_staging.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf"}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_frontend_staging.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_frontend_staging.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf"}, {"check_id": "CKV2_AWS_38", "bc_check_id": "BC_AWS_NETWORKING_83", "check_name": "Ensure Domain Name System Security Extensions (DNSSEC) signing is enabled for Amazon Route 53 public hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_static_staging.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_static_staging.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-38", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"state": {"__end_line__": 4, "__start_line__": 1, "bucket": ["tfstate-${var.project}-${var.env}-us-east-1"], "tags": [{"Env": "${var.env}", "Project": "${var.project}"}], "__address__": "aws_s3_bucket.state"}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf", "repo_file_path": "/bootstrap/main.tf", "file_line_range": [1, 4], "resource": "aws_s3_bucket.state", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "${var.env}", "Project": "${var.project}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"frontend": {"__end_line__": 138, "__start_line__": 134, "bucket": [" != \"\" ?  : \"spiritual-formation-frontend-staging\""], "count": [0], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.s3.aws_s3_bucket.frontend"}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [134, 138], "resource": "module.s3.aws_s3_bucket.frontend", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf"}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_api_staging.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_api_staging.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf"}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_frontend_staging.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_frontend_staging.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf"}, {"check_id": "CKV2_AWS_39", "bc_check_id": "BC_AWS_LOGGING_34", "check_name": "Ensure Domain Name System (DNS) query logging is enabled for Amazon Route 53 hosted zones", "check_result": {"result": "FAILED", "entity": {"aws_route53_zone": {"hosted": {"__end_line__": 16, "__start_line__": 13, "count": [0], "name": ["catholicmentalprayer.com"], "__address__": "module.route53_acm_static_staging.aws_route53_zone.hosted"}}}, "evaluated_keys": ["vpc", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf", "repo_file_path": "/modules/route53_acm/main.tf", "file_line_range": [13, 16], "resource": "module.route53_acm_static_staging.aws_route53_zone.hosted", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-39", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\route53_acm\\main.tf"}, {"check_id": "CKV2_AWS_57", "bc_check_id": "BC_AWS_GENERAL_192", "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled", "check_result": {"result": "FAILED", "entity": {"aws_secretsmanager_secret": {"db": {"__end_line__": 117, "__start_line__": 114, "name": ["local.secret_name"], "tags": ["local.tags"], "__address__": "module.rds.aws_secretsmanager_secret.db"}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [114, 117], "resource": "module.rds.aws_secretsmanager_secret.db", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "local.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV2_AWS_30", "bc_check_id": "BC_AWS_LOGGING_32", "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_db_instance": {"this[0]": {"__end_line__": 177, "__start_line__": 120, "allocated_storage": [20], "apply_immediately": [true], "backup_retention_period": [3], "backup_window": ["22:00-23:00"], "copy_tags_to_snapshot": [true], "db_name": ["spiritualformation"], "db_subnet_group_name": ["aws_db_subnet_group.this[0].name"], "deletion_protection": [false], "depends_on": [["aws_db_parameter_group.pg", "aws_db_subnet_group.this"]], "enabled_cloudwatch_logs_exports": [["postgresql"]], "engine": ["postgres"], "engine_version": ["16.8"], "final_snapshot_identifier": ["sf-staging-final-${replace(${timestamp()}, \":\", \"-\")}"], "identifier": ["True"], "instance_class": ["db.t4g.micro"], "maintenance_window": ["Mon:00:00-Mon:01:00"], "max_allocated_storage": [100], "multi_az": [false], "parameter_group_name": ["aws_db_parameter_group.pg[0].name"], "password": ["random_password.db.result"], "performance_insights_enabled": [false], "publicly_accessible": [false], "skip_final_snapshot": [false], "snapshot_identifier": ["True"], "storage_encrypted": [true], "tags": ["local.tags"], "username": ["sf_admin"], "vpc_security_group_ids": [["aws_security_group.rds[0].id"]], "__address__": "module.rds.aws_db_instance.this[0]"}}}, "evaluated_keys": ["resource_type", "parameter/*/name", "engine"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [120, 177], "resource": "module.rds.aws_db_instance.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "local.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"apprunner_connector": {"__end_line__": 12, "__start_line__": 2, "description": ["App Runner VPC connector SG"], "name": ["sf-staging-apprunner-connector-sg"], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation", "Role": "AppRunnerConnector"}], "vpc_id": ["aws_vpc.this[0].id"], "__address__": "aws_security_group.apprunner_connector"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": null, "file_path": "\\security-groups.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\envs\\staging\\security-groups.tf", "repo_file_path": "/envs/staging/security-groups.tf", "file_line_range": [2, 12], "resource": "aws_security_group.apprunner_connector", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation", "Role": "AppRunnerConnector"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\envs\\staging\\security-groups.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"ecs_tasks": {"__end_line__": 23, "__start_line__": 15, "description": ["Managed by Terraform"], "lifecycle": [{"prevent_destroy": [true]}], "name": ["spiritual-formation-staging-ecs-tasks-sg"], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "vpc_id": ["aws_vpc.this[0].id"], "__address__": "aws_security_group.ecs_tasks"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": null, "file_path": "\\security-groups.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\envs\\staging\\security-groups.tf", "repo_file_path": "/envs/staging/security-groups.tf", "file_line_range": [15, 23], "resource": "aws_security_group.ecs_tasks", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\envs\\staging\\security-groups.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "FAILED", "entity": {"aws_security_group": {"rds[0]": {"__end_line__": 42, "__start_line__": 36, "description": ["Allow Postgres from app runner + ecs + (optional) admin"], "name": ["sf-staging-rds-sg"], "tags": ["merge(local.tags,{'Name': 'sf-staging-rds-sg'})"], "vpc_id": ["aws_vpc.this[0].id"], "__address__": "module.rds.aws_security_group.rds[0]"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf", "repo_file_path": "/modules/rds/main.tf", "file_line_range": [36, 42], "resource": "module.rds.aws_security_group.rds[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "merge(local.tags,{'Name': 'sf-staging-rds-sg'})", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\rds\\main.tf"}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"this[0]": {"__end_line__": 28, "__start_line__": 20, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": ["True"], "__address__": "module.vpc.aws_vpc.this[0]"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [20, 28], "resource": "module.vpc.aws_vpc.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "True", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf"}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"this[0]": {"__end_line__": 28, "__start_line__": 20, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": ["True"], "__address__": "module.vpc.aws_vpc.this[0]"}}}, "evaluated_keys": ["egress/protocol", "egress/from_port", "ingress/from_port", "egress/to_port", "ingress/self", "ingress/to_port", "egress/cidr_blocks", "resource_type", "ingress/protocol"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [20, 28], "resource": "module.vpc.aws_vpc.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "True", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\vpc\\main.tf"}, {"check_id": "CKV2_AWS_65", "bc_check_id": "BC_AWS_GENERAL_187", "check_name": "Ensure access control lists for S3 buckets are disabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket_ownership_controls": {"logs": {"__end_line__": 12, "__start_line__": 7, "bucket": ["aws_s3_bucket.logs.id"], "rule": [{"object_ownership": ["ObjectWriter"]}], "__address__": "module.logging.aws_s3_bucket_ownership_controls.logs"}}}, "evaluated_keys": ["rule/object_ownership"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf", "repo_file_path": "/modules/logging/main.tf", "file_line_range": [7, 12], "resource": "module.logging.aws_s3_bucket_ownership_controls.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-112", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"state": {"__end_line__": 4, "__start_line__": 1, "bucket": ["tfstate-${var.project}-${var.env}-us-east-1"], "tags": [{"Env": "${var.env}", "Project": "${var.project}"}], "__address__": "aws_s3_bucket.state"}}}, "evaluated_keys": ["resource_type", "lifecycle_rule"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf", "repo_file_path": "/bootstrap/main.tf", "file_line_range": [1, 4], "resource": "aws_s3_bucket.state", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "${var.env}", "Project": "${var.project}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"state": {"__end_line__": 4, "__start_line__": 1, "bucket": ["tfstate-${var.project}-${var.env}-us-east-1"], "tags": [{"Env": "${var.env}", "Project": "${var.project}"}], "__address__": "aws_s3_bucket.state"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf", "repo_file_path": "/bootstrap/main.tf", "file_line_range": [1, 4], "resource": "aws_s3_bucket.state", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "${var.env}", "Project": "${var.project}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 5, "__start_line__": 1, "bucket": ["sf-staging-logs"], "force_destroy": [false], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.logging.aws_s3_bucket.logs"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf", "repo_file_path": "/modules/logging/main.tf", "file_line_range": [1, 5], "resource": "module.logging.aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"state": {"__end_line__": 4, "__start_line__": 1, "bucket": ["tfstate-${var.project}-${var.env}-us-east-1"], "tags": [{"Env": "${var.env}", "Project": "${var.project}"}], "__address__": "aws_s3_bucket.state"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf", "repo_file_path": "/bootstrap/main.tf", "file_line_range": [1, 4], "resource": "aws_s3_bucket.state", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "${var.env}", "Project": "${var.project}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"site": {"__end_line__": 26, "__start_line__": 19, "bucket": ["True"], "tags": [{"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.frontend_staging.aws_s3_bucket.site"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [19, 26], "resource": "module.frontend_staging.aws_s3_bucket.site", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 5, "__start_line__": 1, "bucket": ["sf-staging-logs"], "force_destroy": [false], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.logging.aws_s3_bucket.logs"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf", "repo_file_path": "/modules/logging/main.tf", "file_line_range": [1, 5], "resource": "module.logging.aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"metadata": {"__end_line__": 15, "__start_line__": 12, "bucket": [" != \"\" ?  : \"spiritual-formation-staging\""], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.s3.aws_s3_bucket.metadata"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [12, 15], "resource": "module.s3.aws_s3_bucket.metadata", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"frontend": {"__end_line__": 138, "__start_line__": 134, "bucket": [" != \"\" ?  : \"spiritual-formation-frontend-staging\""], "count": [0], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.s3.aws_s3_bucket.frontend"}}}, "evaluated_keys": ["resource_type", "rule/*/status", "replication_configuration/rules/*/status"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [134, 138], "resource": "module.s3.aws_s3_bucket.frontend", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"state": {"__end_line__": 4, "__start_line__": 1, "bucket": ["tfstate-${var.project}-${var.env}-us-east-1"], "tags": [{"Env": "${var.env}", "Project": "${var.project}"}], "__address__": "aws_s3_bucket.state"}}}, "evaluated_keys": ["resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf", "repo_file_path": "/bootstrap/main.tf", "file_line_range": [1, 4], "resource": "aws_s3_bucket.state", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "${var.env}", "Project": "${var.project}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\bootstrap\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"site": {"__end_line__": 26, "__start_line__": 19, "bucket": ["True"], "tags": [{"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.frontend_staging.aws_s3_bucket.site"}}}, "evaluated_keys": ["resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf", "repo_file_path": "/modules/cloudfront_site/main.tf", "file_line_range": [19, 26], "resource": "module.frontend_staging.aws_s3_bucket.site", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "staging", "ManagedBy": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\cloudfront_site\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 5, "__start_line__": 1, "bucket": ["sf-staging-logs"], "force_destroy": [false], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.logging.aws_s3_bucket.logs"}}}, "evaluated_keys": ["resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf", "repo_file_path": "/modules/logging/main.tf", "file_line_range": [1, 5], "resource": "module.logging.aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"metadata": {"__end_line__": 15, "__start_line__": 12, "bucket": [" != \"\" ?  : \"spiritual-formation-staging\""], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.s3.aws_s3_bucket.metadata"}}}, "evaluated_keys": ["resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [12, 15], "resource": "module.s3.aws_s3_bucket.metadata", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"frontend": {"__end_line__": 138, "__start_line__": 134, "bucket": [" != \"\" ?  : \"spiritual-formation-frontend-staging\""], "count": [0], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.s3.aws_s3_bucket.frontend"}}}, "evaluated_keys": ["resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [134, 138], "resource": "module.s3.aws_s3_bucket.frontend", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\s3\\main.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 5, "__start_line__": 1, "bucket": ["sf-staging-logs"], "force_destroy": [false], "tags": [{"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}], "__address__": "module.logging.aws_s3_bucket.logs"}}}, "evaluated_keys": ["resource_type", "versioning_configuration/status", "versioning/enabled"]}, "code_block": null, "file_path": "\\main.tf", "file_abs_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf", "repo_file_path": "/modules/logging/main.tf", "file_line_range": [1, 5], "resource": "module.logging.aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Env": "staging", "Managed": "Terraform", "Project": "spiritual-formation"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "C:\\Users\\kylej\\OneDrive\\Desktop\\Catholic\\spiritual_formation_project_infra\\modules\\logging\\main.tf"}]}, "summary": {"passed": 439, "failed": 71, "skipped": 1, "parsing_errors": 0, "resource_count": 147, "checkov_version": "3.2.461"}}